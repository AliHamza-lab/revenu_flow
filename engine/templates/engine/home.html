{% extends 'engine/base.html' %}

{% block content %}
<div class="animate-slide">
    <section style="margin-bottom: 4rem;">
        <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 2rem;">
            <div>
                <h2 style="font-size: 2rem; font-weight: 800; font-family: 'Outfit';">
                    {% if category_name %}{{ category_name }}{% else %}Recommended for you{% endif %}
                </h2>
                <p style="color: var(--text-muted);">Hand-picked cinematic experiences based on your interests.</p>
            </div>
            <div style="display: flex; gap: 0.75rem;">
                <button class="btn"
                    style="background: var(--surface); border: 1px solid var(--border); padding: 0.5rem; border-radius: 50%;">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <button class="btn"
                    style="background: var(--surface); border: 1px solid var(--border); padding: 0.5rem; border-radius: 50%;">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </button>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem;">
            {% for video in videos %}
            <article class="glass-card"
                style="padding: 0; overflow: hidden; position: relative; cursor: pointer; border-radius: 16px;"
                onclick="window.location='{% url 'watch' video.id %}'">
                <div style="aspect-ratio: 16/9; background: #000; overflow: hidden; position: relative;">
                    {% if video.thumbnail %}
                    <img src="{{ video.thumbnail.url }}" alt="{{ video.title }}"
                        style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s;">
                    {% else %}
                    <div
                        style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #1f1f1f, #000);">
                        <svg width="40" height="40" fill="var(--border)" viewBox="0 0 24 24">
                            <path d="M8 5v14l11-7z" />
                        </svg>
                    </div>
                    {% endif %}
                    <div
                        style="position: absolute; bottom: 10px; right: 10px; background: rgba(0,0,0,0.8); padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; font-weight: 700;">
                        {{ video.duration|default:"10:00" }}
                    </div>
                </div>
                <div style="padding: 1.25rem;">
                    <div style="display: flex; gap: 1rem; align-items: flex-start;">
                        <div
                            style="width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(45deg, var(--primary), var(--secondary)); display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 0.8rem;">
                            {{ video.title|slice:":1"|upper }}
                        </div>
                        <div style="flex: 1;">
                            <h3 style="font-size: 1rem; font-weight: 700; margin-bottom: 0.25rem; line-height: 1.4;">{{
                                video.title }}</h3>
                            <p style="font-size: 0.85rem; color: var(--text-muted);">{{ video.views }} views â€¢ {{
                                video.created_at|timesince }} ago</p>
                        </div>
                    </div>
                </div>
                <style>
                    article:hover img {
                        transform: scale(1.05);
                    }

                    article:hover {
                        border-color: var(--primary);
                    }
                </style>
            </article>
            {% empty %}
            <div style="grid-column: 1/-1; text-align: center; padding: 5rem 0;">
                <p style="color: var(--text-muted); font-size: 1.2rem;">The universe is currently quiet. Start by
                    uploading a video.</p>
            </div>
            {% endfor %}
        </div>
    </section>

    <!-- Category Pills -->
    <div style="display: flex; gap: 1rem; overflow-x: auto; padding-bottom: 1rem; margin-bottom: 3rem;">
        <a href="{% url 'home' %}" class="btn"
            style="background: {% if not category_name %}var(--primary){% else %}var(--glass){% endif %}; white-space: nowrap; border-radius: 20px; font-size: 0.9rem;">All
            Content</a>
        {% for cat in categories %}
        <a href="{% url 'category_videos' cat.slug %}" class="btn"
            style="background: {% if category_name == cat.name %}var(--primary){% else %}var(--glass){% endif %}; white-space: nowrap; border-radius: 20px; font-size: 0.9rem;">{{
            cat.name }}</a>
        {% endfor %}
    </div>
</div>
{% endblock %}